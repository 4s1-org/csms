FROM node:14-alpine

RUN mkdir -p /app
WORKDIR /builds/YellowGarbageBag/csms

RUN mkdir -p simulator/ backend/ shared/

RUN npm install pnpm -g
RUN pnpm set verify-store-integrity false

COPY simulator/package.json ./simulator/
COPY backend/package.json   ./backend/
COPY shared/package.json    ./shared/

COPY pnpm-lock.yaml .
COPY pnpm-workspace.yaml .

RUN pnpm install

RUN rm -rf simulator/ backend/ shared/

